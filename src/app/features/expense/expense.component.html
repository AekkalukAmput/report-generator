<div class="wrapper">
  <div class="calendar">
    <full-calendar [options]="calendarOptions"></full-calendar>
  </div>

  <mat-card
    class="edit-card"
    appearance="outlined"
    [formGroup]="form"
    *ngIf="showForm()"
  >
    <mat-card-header>
      <span class="mat-card-title">{{
        editingId() ? "แก้ไขรายการ" : "เพิ่มรายการ"
      }}</span>
    </mat-card-header>
    <mat-card-content>
      <div class="flex">
        <div class="radio-card">
          <input
            type="radio"
            id="expense-type-income"
            formControlName="type"
            value="income"
            (change)="onTypeChange()"
          />
          <label class="income" for="expense-type-income">รายรับ</label>
        </div>
        <div class="radio-card">
          <input
            type="radio"
            id="expense-type-expense"
            formControlName="type"
            value="expense"
            (change)="onTypeChange()"
          />
          <label class="expense" for="expense-type-expense">รายจ่าย</label>
        </div>
      </div>
      <div class="flex">
        <mat-form-field>
          <mat-label>วันที่</mat-label>
          <input matInput [matDatepicker]="picker" formControlName="date" />
          <mat-datepicker-toggle
            matIconSuffix
            [for]="picker"
          ></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>
        <mat-form-field>
          <mat-label>เวลา</mat-label>
          <input
            matInput
            aria-label="24hr"
            placeholder="24hr"
            readonly
            [ngxTimepicker]="fullTime"
            [format]="24"
            formControlName="time"
          />
          <ngx-material-timepicker
            #fullTime
            [cancelBtnTmpl]="customCancelButton"
            [confirmBtnTmpl]="customConfirmButton"
          ></ngx-material-timepicker>
          <ng-template #customCancelButton>
            <button class="time-btn cancel">ยกเลิก</button>
          </ng-template>
          <ng-template #customConfirmButton>
            <button class="time-btn confirm">ตั้งเวลา</button>
          </ng-template>
          <mat-icon matSuffix [ngxTimepicker]="fullTime">access_time</mat-icon>
        </mat-form-field>
      </div>
      <div class="flex">
        <mat-form-field>
          <mat-label>หมวดหมู่</mat-label>
          <mat-select formControlName="category">
            <mat-optgroup
              *ngFor="let group of categoryDropdown"
              [label]="group.name"
            >
              <mat-option *ngFor="let item of group.items" [value]="item.value">
                {{ item.viewValue }}
              </mat-option>
            </mat-optgroup>
          </mat-select>
        </mat-form-field>
        <mat-form-field>
          <mat-label>จำนวนเงิน (บาท)</mat-label>
          <input
            matInput
            type="text"
            formControlName="amount"
            min="0"
            step="0.01"
            numbersOnly
            currency
            [allowDecimals]="true"
          />
          <span class="prefix-amount" matTextPrefix>฿&nbsp;</span>
        </mat-form-field>
      </div>
      <div class="flex">
        <mat-form-field>
          <mat-label>หมายเหตุ</mat-label>
          <textarea matInput formControlName="note" rows="5"></textarea>
        </mat-form-field>
      </div>
    </mat-card-content>
    <mat-card-actions class="action-buttons">
      <button class="btn-edit" type="button" (click)="submitForm()">
        {{ editingId() ? "บันทึก" : "เพิ่ม" }}
      </button>
      <button class="btn-cancel" type="button" (click)="cancelForm()">
        ยกเลิก
      </button>
      <button
        type="button"
        class="btn-delete"
        *ngIf="editingId()"
        (click)="deleteCurrent()"
      >
        ลบ
      </button>
    </mat-card-actions>
  </mat-card>
</div>
